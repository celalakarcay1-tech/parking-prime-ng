<div class="card">
  <div class="table-header">
    <h2>Ürün Listesi</h2>
    <div class="search-container">
      <span class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input 
          type="text" 
          pInputText 
          [(ngModel)]="globalFilter" 
          placeholder="Ürün adı, kategori veya ID ile ara..." 
          (input)="onGlobalFilter($event)"
        />
      </span>
      <p-button 
        label="Temizle" 
        icon="pi pi-filter-slash" 
        (onClick)="clearFilters()"
        [outlined]="true"
        styleClass="ml-2">
      </p-button>
    </div>
  </div>

  <p-table 
    [value]="filteredProducts" 
    [paginator]="true" 
    [rows]="10" 
    [showCurrentPageReport]="true" 
    currentPageReportTemplate="Toplam {totalRecords} kayıttan {first} - {last} arası gösteriliyor"
    [rowsPerPageOptions]="[5, 10, 25, 50]"
    [tableStyle]="{'min-width': '60rem'}"
    styleClass="p-datatable-striped p-datatable-gridlines"
    [globalFilterFields]="['name','category','id']"
    [sortMode]="'multiple'"
    [selection]="selectedProducts"
    dataKey="id"
    [scrollable]="true"
    scrollHeight="500px">
    
    <ng-template pTemplate="caption">
      <div class="table-info">
        <span *ngIf="selectedProducts.length > 0">
          <strong>{{ selectedProducts.length }}</strong> ürün seçildi
        </span>
      </div>
    </ng-template>

    <ng-template pTemplate="header">
      <tr>
        <th style="width: 3rem">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>
        <th pSortableColumn="id" style="width: 5rem">
          ID <p-sortIcon field="id"></p-sortIcon>
        </th>
        <th pSortableColumn="name" style="width: 25%">
          Ürün Adı <p-sortIcon field="name"></p-sortIcon>
        </th>
        <th pSortableColumn="category" style="width: 15%">
          Kategori <p-sortIcon field="category"></p-sortIcon>
        </th>
        <th pSortableColumn="price" style="width: 15%">
          Fiyat <p-sortIcon field="price"></p-sortIcon>
        </th>
        <th pSortableColumn="stock" style="width: 15%">
          Stok Durumu <p-sortIcon field="stock"></p-sortIcon>
        </th>
        <th style="width: 15%">Toplam Değer</th>
      </tr>
    </ng-template>
    
    <ng-template pTemplate="body" let-product>
      <tr>
        <td>
          <p-tableCheckbox [value]="product"></p-tableCheckbox>
        </td>
        <td>{{ product.id }}</td>
        <td>
          <strong>{{ product.name }}</strong>
        </td>
        <td>
          <span class="category-badge">{{ product.category }}</span>
        </td>
        <td>
          <span class="price-text">{{ product.price | currency:'TRY':'symbol':'1.2-2' }}</span>
        </td>
        <td>
          <p-tag 
            [value]="getStockLabel(product.stock)" 
            [severity]="getSeverity(product.stock)">
          </p-tag>
          <span class="stock-number">({{ product.stock }})</span>
        </td>
        <td>
          <span class="total-value">
            {{ (product.price * product.stock) | currency:'TRY':'symbol':'1.2-2' }}
          </span>
        </td>
      </tr>
    </ng-template>
    
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="7" class="empty-message">
          <div class="empty-content">
            <i class="pi pi-inbox" style="font-size: 3rem; color: #ccc;"></i>
            <p>Kayıt bulunamadı.</p>
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="summary">
      <div class="summary-footer">
        <div class="summary-item">
          <strong>Toplam Ürün:</strong> {{ filteredProducts.length }}
        </div>
        <div class="summary-item">
          <strong>Toplam Stok:</strong> {{ getTotalStock() }}
        </div>
        <div class="summary-item">
          <strong>Toplam Değer:</strong> 
          {{ getTotalValue() | currency:'TRY':'symbol':'1.2-2' }}
        </div>
      </div>
    </ng-template>
  </p-table>
</div>

