<div class="reports-container">
  <div class="reports-header">
    <h2>Raporlar</h2>
    <div class="header-actions">
      <p-button 
        label="Excel'e Aktar" 
        icon="pi pi-file-excel" 
        (onClick)="exportToExcel()"
        [outlined]="true"
        styleClass="mr-2">
      </p-button>
      <p-button 
        label="PDF'e Aktar" 
        icon="pi pi-file-pdf" 
        (onClick)="exportToPDF()"
        [outlined]="true">
      </p-button>
    </div>
  </div>

  <!-- Filtreler -->
  <p-card class="filter-card">
    <div class="filters">
      <div class="filter-group">
        <label>Rapor Tipi</label>
        <p-dropdown 
          [(ngModel)]="reportType" 
          [options]="reportTypes" 
          optionLabel="label" 
          optionValue="value"
          placeholder="Rapor tipi seçin">
        </p-dropdown>
      </div>
      <div class="filter-group">
        <label>Başlangıç Tarihi</label>
        <p-calendar 
          [(ngModel)]="startDate" 
          [showIcon]="true"
          dateFormat="dd.mm.yy"
          (onSelect)="filterReports()">
        </p-calendar>
      </div>
      <div class="filter-group">
        <label>Bitiş Tarihi</label>
        <p-calendar 
          [(ngModel)]="endDate" 
          [showIcon]="true"
          dateFormat="dd.mm.yy"
          (onSelect)="filterReports()">
        </p-calendar>
      </div>
    </div>
  </p-card>

  <!-- İstatistikler -->
  <div class="stats-cards">
    <p-card class="stat-card">
      <div class="stat-content">
        <div class="stat-icon" style="background: #e3f2fd;">
          <i class="pi pi-money-bill" style="color: #1976d2;"></i>
        </div>
        <div class="stat-info">
          <h3>{{ totalRevenue | currency:'TRY':'symbol':'1.2-2' }}</h3>
          <p>Toplam Gelir</p>
        </div>
      </div>
    </p-card>

    <p-card class="stat-card">
      <div class="stat-content">
        <div class="stat-icon" style="background: #e8f5e9;">
          <i class="pi pi-car" style="color: #4CAF50;"></i>
        </div>
        <div class="stat-info">
          <h3>{{ totalVehicles }}</h3>
          <p>Toplam Araç</p>
        </div>
      </div>
    </p-card>

    <p-card class="stat-card">
      <div class="stat-content">
        <div class="stat-icon" style="background: #fff3e0;">
          <i class="pi pi-clock" style="color: #FF9800;"></i>
        </div>
        <div class="stat-info">
          <h3>{{ averageDuration }} saat</h3>
          <p>Ortalama Süre</p>
        </div>
      </div>
    </p-card>
  </div>

  <!-- Grafikler -->
  <div class="charts-container">
    <p-card class="chart-card">
      <h3>Gelir Grafiği</h3>
      <p-chart type="line" [data]="revenueChartData" [options]="chartOptions"></p-chart>
    </p-card>

    <p-card class="chart-card">
      <h3>Araç Sayısı Grafiği</h3>
      <p-chart type="line" [data]="vehicleChartData" [options]="chartOptions"></p-chart>
    </p-card>
  </div>

  <!-- Rapor Tablosu -->
  <p-card class="table-card">
    <h3>Detaylı Rapor</h3>
    <p-table 
      [value]="filteredReports" 
      [paginator]="true" 
      [rows]="10"
      [rowsPerPageOptions]="[5, 10, 25, 50, 100]"
      [virtualScroll]="filteredReports.length > 1000"
      [virtualScrollItemSize]="46"
      styleClass="p-datatable-striped p-datatable-gridlines">
      
      <ng-template pTemplate="header">
        <tr>
          <th>Tarih</th>
          <th>Plaka</th>
          <th>Giriş Saati</th>
          <th>Çıkış Saati</th>
          <th>Süre (saat)</th>
          <th>Tutar</th>
          <th>Ödeme Yöntemi</th>
          <th>Durum</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-report>
        <tr>
          <td>{{ report.date | date:'dd.MM.yyyy' }}</td>
          <td><strong>{{ report.vehiclePlate }}</strong></td>
          <td>{{ report.entryTime | date:'HH:mm' }}</td>
          <td>{{ report.exitTime | date:'HH:mm' }}</td>
          <td>{{ report.duration }}</td>
          <td><strong>{{ report.amount | currency:'TRY':'symbol':'1.2-2' }}</strong></td>
          <td>{{ report.paymentMethod }}</td>
          <td>
            <p-tag 
              [value]="report.status" 
              [severity]="getStatusSeverity(report.status)">
            </p-tag>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="8" class="empty-message">
            <div class="empty-content">
              <i class="pi pi-inbox" style="font-size: 3rem; color: #ccc;"></i>
              <p>Rapor bulunamadı.</p>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>

